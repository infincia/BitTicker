//
//  BitcoinMarket.h
//  Bitcoin Trader
//
//  Created by Matt Stith on 4/27/11.
//  Copyright 2011 Insomnia Addict. All rights reserved.
//

#import <Foundation/Foundation.h>

#import "BitcoinMarketDelegate.h"
#import "RequestHandlerDelegate.h"
#import "SharedSettings.h"

enum kBitcoinMarkets {
    eMarketMtGox = 0,
	eMarketBitcoinCZ = 1,
	eMarketBtcGuild = 2,
    // Used for market enumeration. Keep this as the last value.
    eNumberOfMarkets = 3 
};

@class RequestHandler;

@interface BitcoinMarket : NSObject <RequestHandlerDelegate> {
    RequestHandler *requestHandler;
    id<BitcoinMarketDelegate> _delegate;
    
    NSMutableDictionary *_selectorMap;
	SharedSettings *sharedSettingManager;
	
	NSString *_tradeURL;
	NSString *_tickerURL;
	NSString *_depthURL;
	NSString *_walletURL;
	NSString *_minerURL;
}
-(id)initWithDelegate:(id<BitcoinMarketDelegate>)delegate;

-(void)downloadJsonDataFromURL:(NSURL*)url callback:(SEL)callback;
-(void)downloadJsonDataFromURL:(NSURL*)url withPostData:(NSDictionary*)postData callback:(SEL)callback;

// Overwrite these in each market
-(NSURL*)getTickerDataURL;
-(NSURL*)getRecentTradeURL;

-(void)fetchRecentTrades;
-(void)fetchTicker;
-(void)fetchMarketDepth;
-(void)fetchWallet;
-(void)fetchMiner;

@property (nonatomic, assign) id<BitcoinMarketDelegate> delegate;

@property (readonly,nonatomic,retain) NSString *tradeURL;
@property (readonly,nonatomic,retain) NSString *tickerURL;
@property (readonly,nonatomic,retain) NSString *depthURL;
@property (readonly,nonatomic,retain) NSString *walletURL;
@property (readonly,nonatomic,retain) NSString *minerURL;

@end
